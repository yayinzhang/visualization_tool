import json
from collections import defaultdict
import pandas as pd

# 把你的 records 字串貼到這個變數，記得是完整的
records_json = '[{\"brand\": \"nike\", \"period\": \"month\", \"year\": 2023, \"month\": 1, \"category\": \"feature\", \"data\": {\"feature_counts\": {\"結構性透氣\": 549, \"單向導溼快乾\": 1087, \"透氣散熱\": 645, \"環保訴求\": 877, \"蒸發性散熱\": 907, \"刷毛布保暖\": 737, \"保暖禦寒\": 575, \"反光功能\": 90, \"舒適平滑縫合\": 19, \"化纖素材保暖\": 21, \"撥水\": 61, \"超輕量\": 5, \"抗紫外線\": 4, \"防風機能\": 7, \"透濕\": 2, \"防水\": 8, \"人體生理舒適設計\": 2, \"舒適伸展\": 14, \"一體成型\": 21, \"四面彈\": 28, \"Remade\": 1, \"涼感\": 7, \"雙面彈\": 2, \"中空保溫纖維保暖\": 1, \"羽絨保暖\": 5, \"提升運動效能設計\": 5}}}, {\"brand\": \"nike\", \"period\": \"month\", \"year\": 2023, \"month\": 2, \"category\": \"feature\", \"data\": {\"feature_counts\": {\"單向導溼快乾\": 483, \"保暖禦寒\": 213, \"結構性透氣\": 213, \"刷毛布保暖\": 263, \"透氣散熱\": 287, \"環保訴求\": 312, \"涼感\": 3, \"蒸發性散熱\": 286, \"防水\": 11, \"防風機能\": 8, \"透濕\": 3, \"四面彈\": 11, \"反光功能\": 35, \"撥水\": 26, \"一體成型\": 5, \"化纖素材保暖\": 14, \"超輕量\": 12, \"抗紫外線\": 13, \"舒適平滑縫合\": 4, \"舒適伸展\": 18, \"人體生理舒適設計\": 1, \"提升運動效能設計\": 1, \"中空保溫纖維保暖\": 1}}}, {\"brand\": \"nike\", \"period\": \"month\", \"year\": 2023, \"month\": 3, \"category\": \"feature\", \"data\": {\"feature_counts\": {\"刷毛布保暖\": 213, \"單向導溼快乾\": 596, \"蒸發性散熱\": 244, \"環保訴求\": 477, \"結構性透氣\": 203, \"透氣散熱\": 244, \"保暖禦寒\": 159, \"四面彈\": 7, \"抗紫外線\": 17, \"撥水\": 12, \"舒適平滑縫合\": 10, \"反光功能\": 18, \"舒適伸展\": 9, \"化纖素材保暖\": 11, \"涼感\": 2, \"人體生理舒適設計\": 3, \"雙面彈\": 1, \"防水\": 11, \"一體成型\": 9, \"羽絨保暖\": 1}}}, {\"brand\": \"nike\", \"period\": \"month\", \"year\": 2023, \"month\": 4, \"category\": \"feature\", \"data\": {\"feature_counts\": {\"單向導溼快乾\": 1245, \"蒸發性散熱\": 587, \"刷毛布保暖\": 260, \"環保訴求\": 847, \"保暖禦寒\": 178, \"透氣散熱\": 494, \"結構性透氣\": 381, \"舒適伸展\": 24, \"反光功能\": 61, \"涼感\": 16, \"撥水\": 63, \"一體成型\": 28, \"化纖素材保暖\": 20, \"防水\": 24, \"抗紫外線\": 11, \"人體生理舒適設計\": 7, \"四面彈\": 90, \"提升運動效能設計\": 5, \"超輕量\": 3, \"舒適平滑縫合\": 6, \"防風機能\": 5, \"耐磨功能\": 1, \"透濕\": 2, \"抗菌功能\": 2, \"Remade\": 4}}}, {\"brand\": \"nike\", \"period\": \"month\", \"year\": 2023, \"month\": 5, \"category\": \"feature\", \"data\": {\"feature_counts\": {\"環保訴求\": 295, \"透氣散熱\": 158, \"結構性透氣\": 112, \"刷毛布保暖\": 134, \"保暖禦寒\": 77, \"防水\": 5, \"單向導溼快乾\": 504, \"蒸發性散熱\": 247, \"超輕量\": 3, \"抗紫外線\": 1, \"一體成型\": 15, \"反光功能\": 29, \"撥水\": 22, \"四面彈\": 6, \"舒適伸展\": 8, \"防風機能\": 3, \"舒適平滑縫合\": 4, \"涼感\": 1, \"化纖素材保暖\": 2}}}, {\"brand\": \"nike\", \"period\": \"month\", \"year\": 2023, \"month\": 6, \"category\": \"feature\", \"data\": {\"feature_counts\": {\"單向導溼快乾\": 942, \"蒸發性散熱\": 496, \"結構性透氣\": 279, \"環保訴求\": 616, \"刷毛布保暖\": 184, \"保暖禦寒\": 177, \"透氣散熱\": 282, \"一體成型\": 14, \"舒適伸展\": 12, \"撥水\": 28, \"反光功能\": 40, \"涼感\": 11, \"防風機能\": 4, \"四面彈\": 40, \"抗紫外線\": 13, \"舒適平滑縫合\": 27, \"Remade\": 3, \"防水\": 3, \"人體生理舒適設計\": 5, \"化纖素材保暖\": 1, \"超輕量\": 1, \"異味控制\": 1}}}, {\"brand\": \"nike\", \"period\": \"month\", \"year\": 2023, \"month\": 7, \"category\": \"feature\", \"data\": {\"feature_counts\": {\"單向導溼快乾\": 822, \"環保訴求\": 973, \"一體成型\": 43, \"蒸發性散熱\": 546, \"刷毛布保暖\": 289, \"保暖禦寒\": 192, \"防水\": 5, \"四面彈\": 24, \"結構性透氣\": 287, \"透氣散熱\": 292, \"舒適伸展\": 19, \"撥水\": 59, \"反光功能\": 44, \"抗紫外線\": 14, \"防風機能\": 6, \"涼感\": 6, \"提升運動效能設計\": 4, \"化纖素材保暖\": 2, \"舒適平滑縫合\": 12, \"耐磨功能\": 3, \"人體生理舒適設計\": 1, \"羽絨保暖\": 4, \"超輕量\": 4}}}, {\"brand\": \"nike\", \"period\": \"month\", \"year\": 2023, \"month\": 8, \"category\": \"feature\", \"data\": {\"feature_counts\": {\"結構性透氣\": 159, \"保暖禦寒\": 214, \"透氣散熱\": 189, \"單向導溼快乾\": 505, \"環保訴求\": 581, \"刷毛布保暖\": 277, \"蒸發性散熱\": 346, \"一體成型\": 14, \"舒適伸展\": 11, \"防水\": 10, \"撥水\": 32, \"四面彈\": 23, \"抗紫外線\": 17, \"防風機能\": 6, \"涼感\": 3, \"反光功能\": 22, \"透濕\": 1, \"舒適平滑縫合\": 7, \"超輕量\": 1, \"人體生理舒適設計\": 1, \"化纖素材保暖\": 2}}}, {\"brand\": \"nike\", \"period\": \"month\", \"year\": 2023, \"month\": 9, \"category\": \"feature\", \"data\": {\"feature_counts\": {\"單向導溼快乾\": 782, \"環保訴求\": 1034, \"蒸發性散熱\": 603, \"透氣散熱\": 329, \"結構性透氣\": 248, \"刷毛布保暖\": 452, \"保暖禦寒\": 399, \"抗紫外線\": 66, \"化纖素材保暖\": 37, \"防水\": 15, \"四面彈\": 40, \"撥水\": 63, \"防風機能\": 15, \"舒適伸展\": 14, \"透濕\": 4, \"一體成型\": 21, \"舒適平滑縫合\": 7, \"反光功能\": 55, \"提升運動效能設計\": 6, \"羽絨保暖\": 6, \"涼感\": 14, \"人體生理舒適設計\": 4, \"Remade\": 1, \"超輕量\": 1}}}, {\"brand\": \"nike\", \"period\": \"month\", \"year\": 2023, \"month\": 10, \"category\": \"feature\", \"data\": {\"feature_counts\": {\"環保訴求\": 1027, \"刷毛布保暖\": 467, \"保暖禦寒\": 327, \"單向導溼快乾\": 670, \"蒸發性散熱\": 577, \"透氣散熱\": 279, \"結構性透氣\": 248, \"撥水\": 74, \"化纖素材保暖\": 20, \"涼感\": 5, \"一體成型\": 19, \"四面彈\": 18, \"防風機能\": 16, \"反光功能\": 51, \"防水\": 18, \"抗紫外線\": 5, \"舒適平滑縫合\": 6, \"超輕量\": 2, \"異味控制\": 2, \"抗菌功能\": 2, \"羽絨保暖\": 4, \"人體生理舒適設計\": 1, \"舒適伸展\": 5, \"透濕\": 3}}}, {\"brand\": \"nike\", \"period\": \"month\", \"year\": 2023, \"month\": 11, \"category\": \"feature\", \"data\": {\"feature_counts\": {\"單向導溼快乾\": 247, \"環保訴求\": 590, \"蒸發性散熱\": 210, \"刷毛布保暖\": 273, \"保暖禦寒\": 188, \"透氣散熱\": 141, \"結構性透氣\": 95, \"羽絨保暖\": 4, \"撥水\": 33, \"舒適伸展\": 4, \"舒適平滑縫合\": 1, \"耐磨功能\": 2, \"反光功能\": 15, \"化纖素材保暖\": 17, \"防水\": 15, \"四面彈\": 4, \"防風機能\": 4, \"一體成型\": 15, \"雙面彈\": 14, \"抗紫外線\": 1, \"透濕\": 3, \"超輕量\": 1}}}, {\"brand\": \"nike\", \"period\": \"month\", \"year\": 2023, \"month\": 12, \"category\": \"feature\", \"data\": {\"feature_counts\": {\"單向導溼快乾\": 625, \"蒸發性散熱\": 512, \"環保訴求\": 1186, \"刷毛布保暖\": 333, \"結構性透氣\": 267, \"撥水\": 50, \"透氣散熱\": 320, \"化纖素材保暖\": 9, \"保暖禦寒\": 213, \"防水\": 1, \"羽絨保暖\": 1, \"四面彈\": 47, \"舒適伸展\": 15, \"舒適平滑縫合\": 5, \"人體生理舒適設計\": 11, \"反光功能\": 74, \"一體成型\": 13, \"涼感\": 18, \"提升運動效能設計\": 4, \"防風機能\": 6, \"抗紫外線\": 14, \"超輕量\": 5, \"耐磨功能\": 4, \"異味控制\": 3, \"Remade\": 1}}}]'

# 解析 JSON
records = json.loads(records_json)

# 建立統計表
feature_counts = defaultdict(int)

# 累計每個 feature 的總數
for record in records:
    data = record.get("data", {})
    feature_data = data.get("feature_counts", {})
    for feature, count in feature_data.items():
        feature_counts[feature] += count

# 轉成 DataFrame
df = pd.DataFrame({
    "機能": list(feature_counts.keys()),
    "count": list(feature_counts.values())
})

# 按照數量排序
df = df.sort_values(by="count", ascending=False).reset_index(drop=True)

print(df)